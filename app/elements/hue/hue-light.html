<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="hue-light">

  <style>
    :host {
      display: block;
      box-sizing: border-box;
    }
  </style>

  <template>
    <svg id="svg" viewBox="0 0 415 515" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns" style="width: 100%; height: 100%;">
        <!-- Generator: Sketch 3.4.2 (15855) - http://www.bohemiancoding.com/sketch -->
        <title>hue-a19</title>
        <desc>Created with Sketch.</desc>
        <defs>
            <filter x="-50%" y="-50%" width="200%" height="200%" filterUnits="objectBoundingBox" id="filter-1">
                <feGaussianBlur stdDeviation="0" in="SourceGraphic" result="blur"></feGaussianBlur>
            </filter>
            <filter x="-50%" y="-50%" width="200%" height="200%" filterUnits="objectBoundingBox" id="filter-2">
                <feGaussianBlur stdDeviation="0" in="SourceGraphic" result="blur"></feGaussianBlur>
            </filter>
            <filter x="-50%" y="-50%" width="200%" height="200%" filterUnits="objectBoundingBox" id="filter-3">
                <feGaussianBlur stdDeviation="34.2974494" in="SourceGraphic" result="blur"></feGaussianBlur>
            </filter>
        </defs>
        <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">
            <g id="hue-a19" sketch:type="MSLayerGroup" transform="translate(87.000000, 93.000000)">
                <path d="M238.05541,62.2087505 C242.83641,47.8647505 244.45341,29.2557505 218.39141,16.5057505 C195.65741,5.37275049 148.64141,-0.463249506 120.46941,0.0287504939 C92.2504102,-0.463249506 45.2354102,5.37275049 22.5004102,16.5057505 C-3.56158984,29.2557505 -1.96858984,47.8647505 2.81241016,62.2087505 C16.6404102,102.05275 28.8744102,123.28675 28.8744102,123.28675 L212.01641,123.28675 C212.01641,123.28675 224.25041,102.05275 238.05541,62.2087505 Z" id="bulb-fill" fill="{{settings.color}}" filter="url(#filter-1)" sketch:type="MSShapeGroup"></path>
                <path d="M238.05541,62.2087505 C242.83641,47.8647505 244.45341,29.2557505 218.39141,16.5057505 C195.65741,5.37275049 148.64141,-0.463249506 120.46941,0.0287504939 C92.2504102,-0.463249506 45.2354102,5.37275049 22.5004102,16.5057505 C-3.56158984,29.2557505 -1.96858984,47.8647505 2.81241016,62.2087505 C16.6404102,102.05275 28.8744102,123.28675 28.8744102,123.28675 L212.01641,123.28675 C212.01641,123.28675 224.25041,102.05275 238.05541,62.2087505 Z" id="bulb-outline" stroke="#000000" stroke-width="4.8" filter="url(#filter-2)" sketch:type="MSShapeGroup"></path>
                <path d="M238.05541,62.2087505 C242.83641,47.8647505 244.45341,29.2557505 218.39141,16.5057505 C195.65741,5.37275049 148.64141,-0.463249506 120.46941,0.0287504939 C92.2504102,-0.463249506 45.2354102,5.37275049 22.5004102,16.5057505 C-3.56158984,29.2557505 -1.96858984,47.8647505 2.81241016,62.2087505 C16.6404102,102.05275 28.8744102,123.28675 28.8744102,123.28675 L212.01641,123.28675 C212.01641,123.28675 224.25041,102.05275 238.05541,62.2087505 Z" id="bulb-glow" fill="#DDF81C" filter="url(#filter-3)" sketch:type="MSShapeGroup"></path>
                <path d="M71,325 L71,388.211 C71,395.641 82.672,400.984 91.695,403.094 C93.289,406.282 98.093,411.602 103.39,417.438 C110.515,419.829 129.594,419.829 136.719,417.438 C142.016,411.602 146.797,406.282 148.391,403.094 C157.438,400.985 169.133,395.641 169.133,388.211 L169.133,325 L71,325 Z" id="socket" stroke="#000000" stroke-width="4.8" fill="#EDEDE6" sketch:type="MSShapeGroup"></path>
                <path d="M173.6737,339.84483 L117.8457,344.64983 L117.3527,344.67283 L64.9937,349.17283" id="thread-1" stroke="#000000" stroke-width="4.8" stroke-linecap="round" stroke-linejoin="round" sketch:type="MSShapeGroup"></path>
                <path d="M174.4477,355.71183 L118.6657,360.49383 L118.1737,360.56383 L65.8137,365.04083" id="thread-2" stroke="#000000" stroke-width="4.8" stroke-linecap="round" stroke-linejoin="round" sketch:type="MSShapeGroup"></path>
                <path d="M173.6737,371.57983 L117.8457,376.36083 L117.3527,376.40783 L64.9937,380.90783" id="thread-3" stroke="#000000" stroke-width="4.8" stroke-linecap="round" stroke-linejoin="round" sketch:type="MSShapeGroup"></path>
                <path d="M29.3127,123.74483 C59.0787,216.74783 56.9457,307.59583 56.9457,307.59583 L71.8287,324.61183 L169.9617,324.61183 L184.8447,307.59583 C184.8457,307.59483 182.6897,216.74783 212.4547,123.74483 L29.3127,123.74483 Z" id="body" stroke="#000000" stroke-width="4.8" fill="#F1F1F1" sketch:type="MSShapeGroup"></path>
            </g>
        </g>
    </svg>
  </template>

  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'hue-light',

        properties: {
          hue: Number,
          saturation: Number,
          brightness: Number
        },

        observers: [
          '_hueChanged(hue)',
          '_saturationChanged(saturation)',
          '_brightnessChanged(brightness)'
        ],

        _hueChanged: function(hue) {
          this._updateColor()
        },

        _saturationChanged: function(saturation) {
          this._updateColor()
        },

        _brightnessChanged: function(brightness) {
          this._updateColor()
        },

        _updateColor: function() {
          // hue < 0.1 -> hue = 0.1, brightness = 0.8
          var rgb = this._hsvToRgb(this.hue, this.saturation, 1)

          var color = 'rgb(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ')'
          // console.log(color)
          var svgDoc = this.$.svg
          var fill = svgDoc.getElementById("bulb-fill")
          fill.setAttributeNS(null, 'fill', color)
          var glow = svgDoc.getElementById("bulb-glow")
          glow.setAttributeNS(null, 'fill', color)
        },

        ready: function() {
        },

        attached: function() {
        },

        detached: function() {
        },

        setColor: function(color) {
          // console.log(color)
          this.set('color', color)
        },

        _hsvToRgb: function(h, s, v) {
          var r, g, b, i, f, p, q, t
          if (arguments.length === 1) {
              s = h.s, v = h.v, h = h.h
          }
          i = Math.floor(h * 6)
          f = h * 6 - i
          p = v * (1 - s)
          q = v * (1 - f * s)
          t = v * (1 - (1 - f) * s)
          switch (i % 6) {
              case 0: r = v, g = t, b = p; break
              case 1: r = q, g = v, b = p; break
              case 2: r = p, g = v, b = t; break
              case 3: r = p, g = q, b = v; break
              case 4: r = t, g = p, b = v; break
              case 5: r = v, g = p, b = q; break
          }
          return {
              r: Math.round(r * 255),
              g: Math.round(g * 255),
              b: Math.round(b * 255)
          }
        }
      });
    })();
  </script>

</dom-module>
